{% extends 'base.html.twig' %}

{# Titre de l'onglet du navigateur #}
{% block title %}Détail de la sortie - {{ sortie.nom }}{% endblock %}

{% block body %}
    <div class="max-w-4xl mx-auto p-6 bg-white shadow-md rounded-lg mt-10 mb-10">

        {# Titre de la page #}
        <h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">
            Afficher une sortie
        </h1>

        {# Grille responsive : 1 colonne sur mobile, 2 colonnes sur écran large #}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 mb-8">

            {# === COLONNE GAUCHE : Infos de la sortie === #}
            <div class="space-y-4">
                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Nom de la sortie :</span>
                    <span class="text-gray-900">{{ sortie.nom }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Date et heure :</span>
                    <span class="text-gray-900">{{ sortie.dateHeureDebut|date('d/m/Y H:i') }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Date limite :</span>
                    <span class="text-gray-900">{{ sortie.dateLimiteInscription|date('d/m/Y') }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Places :</span>
                    <span class="text-gray-900">{{ sortie.nbInscriptionsMax }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Durée :</span>
                    <span class="text-gray-900">{{ sortie.duree }} minutes</span>
                </div>

                <div class="flex flex-col pt-2">
                    <span class="font-semibold text-gray-700 mb-1">Description et infos :</span>
                    <p class="text-gray-600 text-sm bg-gray-50 p-3 rounded">
                        {{ sortie.infosSortie|default('Aucune description fournie.') }}
                    </p>
                </div>
            </div>

            {# === COLONNE DROITE : Infos Lieu & Campus === #}
            <div class="space-y-4">
                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Campus :</span>
                    <span class="text-gray-900">{{ sortie.campus.nom }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Lieu :</span>
                    <span class="text-gray-900">{{ sortie.lieu.nom }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Rue :</span>
                    <span class="text-gray-900">{{ sortie.lieu.rue }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Code postal :</span>
                    <span class="text-gray-900">
                        {{ sortie.lieu.ville.codePostal }} {{ sortie.lieu.ville.nom }}
                    </span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Latitude :</span>
                    <span class="text-gray-900">{{ sortie.lieu.latitude }}</span>
                </div>

                <div class="flex justify-between border-b border-gray-100 pb-2">
                    <span class="font-semibold text-gray-700">Longitude :</span>
                    <span class="text-gray-900">{{ sortie.lieu.longitude }}</span>
                </div>
            </div>
        </div>

        {# === LISTE DES PARTICIPANTS === #}
        <div class="mt-10">
            <h2 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500 inline-block">
                Liste des participants inscrits
            </h2>

            <div class="overflow-x-auto shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                <table class="min-w-full divide-y divide-gray-300">
                    <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="py-3.5 px-3 text-left text-sm font-semibold text-gray-900">Pseudo</th>
                        <th scope="col" class="py-3.5 px-3 text-left text-sm font-semibold text-gray-900">Nom complet</th>
                    </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 bg-white">
                    {# Boucle sur la collection 'inscrits' de l'entité Sortie #}
                    {% for participant in sortie.inscrits %}
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-blue-600 sm:pl-6">
                                {# Lien vers le profil via MemberController (route: app_member_show) #}
                                <a href="{{ path('app_member_show', {'pseudo': participant.pseudo}) }}" class="hover:underline">
                                    {{ participant.pseudo }}
                                </a>
                            </td>
                            <td class="whitespace-nowrap py-4 px-3 text-sm text-gray-500">
                                {{ participant.prenom }} {{ participant.nom|upper }}
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="2" class="py-4 text-center text-sm text-gray-500 italic">
                                Aucun participant inscrit pour le moment.
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        {# === BOUTON RETOUR === #}
        <div class="mt-8 text-center">
            {# Utilisation de la route 'app_accueil' pour afficher la liste des sorties #}
            <a href="{{ path('app_accueil') }}" class="text-blue-600 hover:text-blue-800 font-medium hover:underline">
                &larr; Retour à la liste des sorties
            </a>
        </div>

    </div>
{% endblock %}
