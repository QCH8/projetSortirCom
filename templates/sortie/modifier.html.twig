{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} - Modifier la sortie{% endblock %}

{% block body %}
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <h1 class="text-3xl font-extrabold text-gray-900 mb-8 text-center">
            Modifier la sortie : {{ sortie.nom }}
        </h1>

        {# Début du formulaire #}
        {{ form_start(form, {'attr': {'class': 'space-y-8'}}) }}

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            {# === COLONNE GAUCHE : Détails de la sortie === #}
            <div class="bg-white shadow sm:rounded-lg border border-gray-200 h-fit">
                <div class="px-4 py-5 sm:px-6 bg-gray-50 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        Informations générales
                    </h3>
                </div>

                <div class="p-6 space-y-6">
                    <div>
                        {{ form_label(form.nom, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                        {{ form_widget(form.nom, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                        {{ form_errors(form.nom, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                    </div>

                    <div>
                        {{ form_label(form.dateHeureDebut, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                        {{ form_widget(form.dateHeureDebut, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                        {{ form_errors(form.dateHeureDebut, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                    </div>

                    <div>
                        {{ form_label(form.dateLimiteInscription, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                        {{ form_widget(form.dateLimiteInscription, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                        {{ form_errors(form.dateLimiteInscription, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.nbInscriptionsMax, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                            {{ form_widget(form.nbInscriptionsMax, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                            {{ form_errors(form.nbInscriptionsMax, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                        </div>
                        <div>
                            {{ form_label(form.duree, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                            <div class="relative mt-1">
                                {{ form_widget(form.duree, {'attr': {'class': 'block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm pr-12'}}) }}
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">min</span>
                                </div>
                            </div>
                            {{ form_errors(form.duree, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.infosSortie, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                        {{ form_widget(form.infosSortie, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm', 'rows': 4}}) }}
                        {{ form_errors(form.infosSortie, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                    </div>
                </div>
            </div>

            {# === COLONNE DROITE : Localisation === #}
            <div class="space-y-8">
                <div class="bg-white shadow sm:rounded-lg border border-gray-200">
                    <div class="px-4 py-5 sm:px-6 bg-gray-50 border-b border-gray-200">
                        <h3 class="text-lg leading-6 font-medium text-gray-900">
                            Localisation
                        </h3>
                    </div>

                    <div class="p-6 space-y-6">
                        <div>
                            <label for="campus_display" class="block text-sm font-medium text-gray-700">Campus organisateur</label>
                            <input type="text" id="campus_display" disabled value="{{ app.user.campus.nom }}"
                                   class="mt-1 block w-full bg-gray-100 border-gray-300 rounded-md shadow-sm text-gray-500 cursor-not-allowed sm:text-sm">
                        </div>

                        <div>
                            {{ form_label(form.ville, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                            {{ form_widget(form.ville, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                        </div>

                        <div class="relative">
                            <div class="flex justify-between">
                                {{ form_label(form.lieu, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700'}}) }}
                                <button type="button" class="text-sm text-blue-600 hover:text-blue-500 font-medium hover:underline focus:outline-none">
                                    + Ajouter un lieu
                                </button>
                            </div>
                            {{ form_widget(form.lieu, {'attr': {'class': 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm'}}) }}
                            {{ form_errors(form.lieu, {'attr': {'class': 'text-red-600 text-sm mt-1'}}) }}
                        </div>

                        <div id="lieu-details" class="bg-blue-50 p-4 rounded-md border border-blue-100 hidden">
                            <p class="text-sm text-blue-800"><span class="font-bold">Rue :</span> <span id="lieu-rue">--</span></p>
                            <p class="text-sm text-blue-800"><span class="font-bold">Code postal :</span> <span id="lieu-cp">--</span></p>
                        </div>
                    </div>
                </div>

                {# === ACTIONS === #}
                <div class="flex flex-col sm:flex-row justify-center sm:justify-end gap-4 pt-4">
                    <a href="{{ path('app_accueil') }}" class="w-full sm:w-auto px-6 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 text-center">
                        Annuler
                    </a>

                    <button type="submit" class="w-full sm:w-auto px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Enregistrer
                    </button>

                    <button type="submit" name="publier" value="true" class="w-full sm:w-auto px-6 py-3 border border-transparent shadow-sm text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Publier la sortie
                    </button>
                </div>
            </div>
        </div>
        {{ form_end(form) }}
    </div>
{% endblock %}
